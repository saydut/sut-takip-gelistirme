<!-- File: templates/index.html  (PATCH: main bölümünü günceller) -->
{% extends "base.html" %}

{% block title %}Süt Takip Paneli{% endblock %}

{% block head_extra %}
    <link href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tom-select@2.3.1/dist/css/tom-select.bootstrap5.css" rel="stylesheet">
{% endblock %}

{% block content %}
<header class="bg-white shadow-sm sticky top-0 z-30 border-b border-gray-200">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between h-16">
      <div class="flex items-center">
        <div class="bg-brand-600 text-white p-2 rounded-lg shadow-sm mr-3">
          <i class="fa-solid fa-cow text-xl"></i>
        </div>
        <div>
          <h1 class="text-lg font-bold text-gray-900">Süt Takip</h1>
          <p class="text-xs text-gray-500 hidden sm:block">{{ session.get('user', {}).get('sirket_adi') }}</p>
        </div>
      </div>
      <div class="flex items-center space-x-3">
        {% if session.get('user', {}).get('rol') == 'ciftci' %}
          {% include '_ciftci_hizli_islemler.html' %}
        {% else %}
          {% include '_hizli_islemler.html' %}
        {% endif %}
      </div>
    </div>
  </div>
</header>

<main class="flex-1 overflow-y-auto bg-gray-50 p-4">
  <!-- Neden: JS çiftçi görünümünde .main-wrapper içindeki kardeşleri yönetiyor -->
  <div class="max-w-7xl mx-auto main-wrapper">
    <div id="alert-container" class="mb-4"></div>

    {% if session.get('user', {}).get('rol') != 'ciftci' %}
      <!-- (MEVCUT) Firma/Toplayıcı/Admin ana grid burada kalır -->
      <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
        <!-- ... mevcut kartlarınız ve listeleriniz ... -->
      </div>
    {% else %}
      <!-- (YENİ) Çiftçi Paneli iskeleti -->
      <div id="ciftci-panel" class="space-y-6">
        <!-- Özet kartları konteyneri; içerik JS ile doldurulur -->
        <div id="ciftci-ozet-kartlari" class="grid grid-cols-2 md:grid-cols-5 gap-4"></div>

        <!-- Süt Girdilerim -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
          <div class="bg-brand-50 px-4 py-3 border-b border-gray-100">
            <h3 class="text-sm font-semibold text-gray-800"><i class="fa-solid fa-glass-water mr-2"></i>Süt Girdilerim</h3>
          </div>
          <div class="p-4">
            <div id="ciftci-sut-veri-yok" class="text-center text-gray-500 hidden">Kayıt bulunamadı.</div>
            <div class="overflow-x-auto">
              <table class="min-w-full text-sm">
                <thead class="text-gray-500">
                  <tr>
                    <th class="text-left py-2">Tarih</th>
                    <th class="text-left py-2">Tanker</th>
                    <th class="text-right py-2">Litre</th>
                    <th class="text-right py-2">Fiyat</th>
                    <th class="text-right py-2">Toplam</th>
                  </tr>
                </thead>
                <tbody id="ciftci-sut-tablosu" class="divide-y divide-gray-100"></tbody>
              </table>
            </div>
            <nav id="ciftci-sut-sayfalama" class="flex justify-center mt-4"></nav>
          </div>
        </div>

        <!-- Yem Alımlarım -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
          <div class="bg-brand-50 px-4 py-3 border-b border-gray-100">
            <h3 class="text-sm font-semibold text-gray-800"><i class="fa-solid fa-wheat-awn mr-2"></i>Yem Alımlarım</h3>
          </div>
          <div class="p-4">
            <div id="ciftci-yem-veri-yok" class="text-center text-gray-500 hidden">Kayıt bulunamadı.</div>
            <div class="overflow-x-auto">
              <table class="min-w-full text-sm">
                <thead class="text-gray-500">
                  <tr>
                    <th class="text-left py-2">Tarih</th>
                    <th class="text-left py-2">Ürün</th>
                    <th class="text-right py-2">Miktar (KG)</th>
                    <th class="text-right py-2">Birim Fiyat</th>
                    <th class="text-right py-2">Toplam</th>
                  </tr>
                </thead>
                <tbody id="ciftci-yem-tablosu" class="divide-y divide-gray-100"></tbody>
              </table>
            </div>
            <nav id="ciftci-yem-sayfalama" class="flex justify-center mt-4"></nav>
          </div>
        </div>

        <!-- Finans İşlemlerim -->
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
          <div class="bg-brand-50 px-4 py-3 border-b border-gray-100">
            <h3 class="text-sm font-semibold text-gray-800"><i class="fa-solid fa-wallet mr-2"></i>Finans İşlemlerim</h3>
          </div>
          <div class="p-4">
            <div id="ciftci-finans-veri-yok" class="text-center text-gray-500 hidden">Kayıt bulunamadı.</div>
            <div class="overflow-x-auto">
              <table class="min-w-full text-sm">
                <thead class="text-gray-500">
                  <tr>
                    <th class="text-left py-2">Tarih</th>
                    <th class="text-left py-2">İşlem</th>
                    <th class="text-right py-2">Tutar</th>
                    <th class="text-left py-2">Açıklama</th>
                  </tr>
                </thead>
                <tbody id="ciftci-finans-tablosu" class="divide-y divide-gray-100"></tbody>
              </table>
            </div>
            <nav id="ciftci-finans-sayfalama" class="flex justify-center mt-4"></nav>
          </div>
        </div>
      </div>
    {% endif %}
  </div>
</main>
{% endblock %}
